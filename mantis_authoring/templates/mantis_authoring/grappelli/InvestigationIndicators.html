{% extends "mantis_authoring/grappelli/base.html" %}

{% comment %}
Copyright (c) Siemens AG, 2013

This file is part of MANTIS.  MANTIS is free software: you can
redistribute it and/or modify it under the terms of the GNU General Public
License as published by the Free Software Foundation; either version 2
of the License, or(at your option) any later version.

This program is distributed in the hope that it will be useful, but WITHOUT
ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more
details.

You should have received a copy of the GNU General Public License along with
this program; if not, write to the Free Software Foundation, Inc., 51
Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
{% endcomment %}

{% load staticfiles %}

{% block javascripts %}
{{ block.super }}
<script>
  var data_main = '{% static 'mantis_authoring/js/app/InvestigationIndicators/' %}';
</script>
<script src="{% static 'mantis_authoring/js/InvestigationIndicators.js' %}"></script>
{% endblock javascripts %}


{% block content %}
<div id="dda-messages">
  <ul class="grp-messagelist">
  </ul>
</div>

<div id="dda-main-container" style="display:none;">

  <div id="dda-container-tabs">
    <ul>
      <li><a href="#dda-tab-investigation">Investigation</a></li>
      <li><a href="#dda-tab-observables">Observables</a></li>
      <li><a href="#dda-tab-threatactors">Associated Threat Actors</a></li>
    </ul>


    <!-- Object Package Tab -->
    <div id="dda-tab-investigation" class="l-2cr-fluid l-d-12">
      <div class="c-1">
        <div class="grp-module">
          <h2>Package Meta</h2>
          <div class="grp-row" id="dda-investigation-meta">
            <dl style="width:100%; overflow:hidden;">
              <dt style="float:left; width:10%;margin-top:4px;font-weight:bold;"><span>INVES -</span></dt>
              <dd style="float:left; width:90%;"><input type="text" name="investigation_header_title" placeholder=""></dd>
            </dl>
            <input type="hidden" name="investigation_package_id">
            <textarea rows="3" type="text" name="investigation_header_description" placeholder="Description"></textarea>
            <select name="investigation_header_tlp"><option value="WHITE">White</option><option value="GREEN">Green</option><option value="AMBER">Amber</option><option value="RED">Red</option></select>
            <hr>
            <div class="pull-left">
              <button id="dda-investigation-save" class="pull-left">Save Draft</button>
              <button id="dda-investigation-save-and-release">Save & Release</button><br/>
              <button id="dda-investigation-load" class="pull-left">Load Draft</button>
            </div>
            <div class="pull-right">
              <button id="dda-investigation-import">Import to MANTIS</button><br/>
            </div>
          </div>
          <div class="grp-row" id="dda-stix-debug">
            <button id="dda-stix-debug_show_stix">Show STIX</button>
            <button id="dda-stix-debug_show_json">Show JSON</button>
            <button id="dda-stix-debug_load_json">Load JSON</button>
          </div>
        </div>
      </div>


      
      <div class="c-2">
        <div class="grp-module">
          <h2>Package Contents</h2>
          <div id="dda-investigation-observables" class="grp-row">
          </div>
        </div>
      </div>

    </div>


    <!-- Observables Tab -->
    <div id="dda-tab-observables" class="l-2cr-fluid l-d-12">
      <div class="c-1">
        <div class="grp-module">
          <h2>File Dropzone</h2>
          <form class="grp-row dropper" id="dda-observable-filedrop" action="{% url 'url.mantis_authoring.upload_file' %}"method="post" enctype='multipart/form-data' target="dda-observable_upload-target">
            <input type="hidden" name="dda_dropzone_type_allow" value=""/>
            {% csrf_token %}
            <iframe name="dda-observable_upload-target" src="" onLoad="" style='width:0;height:0;border:0px solid #fff'></iframe>
          </form>
        </div>
        <div class="grp-module">
          <h2>Observable Templates</h2>
          <div class="grp-row">
            <div class="grp-row" id="dda-observable-pool-elements">
            </div>
          </div>
        </div>
      </div>
      <div class="c-2">
        <div class="grp-module">
          <h2 id="dda-template-head" class="clearfix">Pool <button id="dda-template-head-toogle" class="pull-right">Toggle All</button> </h2>
          <div class="grp-row" id="dda-observable-pool-list"></div>
        </div>
      </div>
    </div>

  </div>


  <div id="dda-threatactor-template-pool" style="display:none;">
    {% for threatActorForm in threatActorForms %}
    <div class="dda-threatactor-template" id="dda-threatactor-template_{{ threatActorForm.object_type.value }}">
      <table>
        {{ threatActorForm.as_table }}
      </table>
    </div>
    {% endfor %}
  </div>

  <div id="dda-observable-template-pool" style="display:none;">
    {% for observableForm in observableForms %}
    <div class="dda-observable-template" id="dda-observable-template_{{ observableForm.object_type.value }}_{{ observableForm.object_subtype.value }}">
      <table>
        {{ observableForm.as_table }}
      </table>
    </div>
    {% endfor %}
  </div>


</div>
{% endblock content %}
